{% set toggle = toggle if toggle is defined else None %}
{% set runs = runs if runs is defined else [] %}
{% set show_delete = show_delete if show_delete is defined else false %}
{% set show_gauge = show_gauge if show_gauge is defined else false %}
{% set header = header if header is defined else none %}
{% set count = count if count is defined else none %}
{% set alt = alt if alt is defined else "" %}
{% set cookie_name = cookie_name if cookie_name is defined else (toggle ~ '_state' if toggle else '') %}
{% set toggle_state = toggle_state if toggle_state is defined else "Show" %}
{% set pages = pages if pages is defined else [] %}
{% set panel_id = panel_id if panel_id is defined else (toggle if toggle else 'finished') %}
{% if toggle %}
  <script>
    function toggle{{ toggle | capitalize }}() {
      const button = document.getElementById("{{ toggle }}-button");
      const active = button.textContent.trim() === "Hide";
      button.textContent = active ? "Show" : "Hide";
      document.cookie =
        "{{ cookie_name }}" + "=" + button.textContent.trim() + "; max-age={{ 60 * 60 * 24 * 365 * 10 }}; SameSite=Lax";
    }

    document.addEventListener("DOMContentLoaded", () => {
      const button = document.getElementById("{{ toggle }}-button");
      button?.addEventListener("click", () => toggle{{ toggle | capitalize }}());
    });
  </script>
{% endif %}

<h4>
{% if toggle %}
  <a id="{{ toggle }}-button" class="btn btn-sm btn-light border"
     data-bs-toggle="collapse" href="#{{ toggle }}" role="button" aria-expanded="false"
      aria-controls="{{ toggle }}">
  {{ 'Hide' if toggle_state == 'Hide' else 'Show' }}
  </a>
{% endif %}
{% if header is not none and count is not none %}
  <span id="{{ panel_id }}-count">{{ header }} - {{ count }} tests</span>
{% elif header is not none %}
  {{ header }}
{% elif count is not none %}
  {{ count }} tests
{% endif %}
</h4>

<section
{% if toggle %}
  id="{{ toggle }}"
  class="{{ 'collapse show' if toggle_state == 'Hide' else 'collapse' }}"
{% endif %}
>

  {% with pages=pages %}
    {% include "pagination.html.j2" %}
  {% endwith %}

  <div class="table-responsive-lg">
    <table class="table table-striped table-sm run-table">
      <thead></thead>
      <tbody id="{{ panel_id }}-tbody">
        {% for row in runs %}
          {% include "run_table_row_fragment.html.j2" %}
        {% endfor %}
        {% if alt and count == 0 %}
          <tr>
            <td> {{ alt }} </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
  {% with pages=pages %}
    {% include "pagination.html.j2" %}
  {% endwith %}
</section>
